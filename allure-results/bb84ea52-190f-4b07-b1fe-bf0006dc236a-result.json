{"name": "test_birth_certificate_old_upload", "status": "broken", "statusDetails": {"message": "selenium.common.exceptions.TimeoutException: Message: \nStacktrace:\nNoSuchElementError: An element could not be located on the page using the given search parameters.\n    at AndroidUiautomator2Driver.findElOrEls (C:\\Users\\a.jamshidi\\.appium\\node_modules\\appium-uiautomator2-driver\\node_modules\\appium-android-driver\\lib\\commands\\find.ts:86:11)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at AndroidUiautomator2Driver.findElOrElsWithProcessing (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:60:12)\n    at AndroidUiautomator2Driver.findElement (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:75:12)", "trace": "open_app_without_login = <appium.webdriver.webdriver.WebDriver (session=\"5731658c-e136-4ceb-8bfb-fae35cf13b07\")>\n\n    @allure.epic(\"KYC\")\n    @allure.feature(\"Create a new user account - Old Birth Certificate Upload\")\n    @allure.story(\"Complete account creation by uploading old birth certificate\")\n    # Suites\n    @allure.suite(f\"version:{VERSION}\")\n    @allure.sub_suite(\"Tests for Old Birth Certificate Upload\")\n    @allure.severity(allure.severity_level.BLOCKER)\n    # Links\n    @allure.link(\"https://jira.sdb247.com/browse/\", name=\"Jira Task\")\n    def test_birth_certificate_old_upload(open_app_without_login):\n        driver = open_app_without_login\n        # تولید داده‌های کاربر\n        phone_number = mobile_number_generator()\n        tracing_code = national_code_generator()\n        username = username_generator()\n        # بارگذاری فایل JSON برای دریافت متون مرجع\n        text_reference = load_text_reference()\n        setup_user_account_creation_steps(driver, phone_number, tracing_code, username, text_reference)\n    \n        try:\n    \n            # # مرحله 17: انتخاب گزینه 'شناسنامه'\n            # with allure.step(\"Select 'birth_certificate' option\"):\n            #     select_national_card = SelectNationalCardOrTrackerIdPage(driver)\n            #     select_national_card.click_birth_certificate()\n            #     logger.info(\"گزینه 'شناسنامه' انتخاب شد.\")\n            #\n            # with allure.step(\"Enter national code\"):\n            #     traking_code_page = TrakingCodePage(driver)\n            #     traking_code_page.enter_tracing_code(tracing_code)\n            #     logger.info(f\"کد پیگیری وارد شد: {tracing_code}\")\n            #     traking_code_page.click_next_button()\n            #     logger.info(\"روی دکمه ادامه کلیک شد.\")\n            #\n            # # مرحله 17: انتخاب گزینه 'شناسنامه جدید'\n            # with allure.step(\"Select 'birth_certificate_new' option\"):\n            #     select_type_cert = SelectTypeBirthCertificatePage(driver)\n            #     select_type_cert.click_birth_certificate_old()\n            #     logger.info(\"گزینه 'شناسنامه قدیم' انتخاب شد.\")\n            # try:\n            #     camera_permission_page = NotificationPermissionPage(driver)\n            #     camera_permission_page.allow_camera_permission()\n            #     logger.info(\"دسترسی به دوربین تأیید شد.\")\n            # except TimeoutException:\n            #     logger.info(\"مجوز دوربین نمایش داده نشد، ادامه دهید.\")\n            #\n            # with allure.step(\"select gallery button\"):\n            #     take_photo_page = TakePhotoPage(driver)\n            #     take_photo_page.click_select_from_gallery_circle_button()\n            #     logger.info(\"روی دکمه انتخاب تصویر از گالری کلیک شد.\")\n            #\n            # # مرحله 18: گرفتن عکس جلو و پشت کارت ملی\n            # with allure.step(\"click on first image from gallery\"):\n            #     gallery_page = GalleryPage(driver)\n            #     gallery_page.click_album_button()\n            #     gallery_page.click_favorite_album()\n            #     gallery_page.click_second_photo()\n            #     logger.info(\"روی اولین عکس گالری برای تصویر صفحه اول شناسنامه کلیک شد.\")\n            #\n            # with allure.step(\"select confirm button\"):\n            #     edit_photo_page = EditPhotoPage(driver)\n            #     edit_photo_page.click_confirm_button()\n            #     logger.info(\"در صفحه ویرایش تصویر بر روی ذکمه ادامه کلیک شد.\")\n            #\n            # with allure.step(\"select front of national card image\"):\n            #     confirm_photo_page = ConfirmPhotoPage(driver)\n            #     confirm_photo_page.click_confirm_photo()\n            #     logger.info(\"روی ادامه کلیک شد.\")\n            #     confirm_photo_modal = ConfirmPhotoModal(driver)\n            #     logger.info(\"روی تایید کلیک شد.\")\n            #     # confirm_photo_modal.click_confirm_photo()\n            #     logger.info(\"عکس تایید شد.\")\n            #\n            # with allure.step(\"Take photo from back of national card\"):\n            #     take_photo_page.click_select_from_gallery_circle_button()\n            #     gallery_page.click_album_button()\n            #     gallery_page.click_favorite_album()\n            #     gallery_page.click_first_photo()\n            #     logger.info(\"عکس صفحه دوم شناسنامه گرفته شد.\")\n            #\n            # with allure.step(\"Click confirm button\"):\n            #     edit_photo_page.click_confirm_button()\n            #     confirm_photo_page.click_confirm_photo()\n            #     # confirm_photo_modal.click_confirm_photo()\n            #     logger.info(\"عکس تایید شد.\")\n    \n            # with allure.step(\"Click next button\"):\n            #     logger.info(\"کلیک روی دکمه 'ادامه'...\")\n            #     create_account_in_blu_state_page = CreateAccountInBluStatePage(driver)\n            #     create_account_in_blu_state_page.click_confirm_button()\n            #     logger.info(\"دکمه 'ادامه' کلیک شد.\")\n    \n            # مرحله 19: انتخاب شغل\n            with allure.step(\"Select job for user\"):\n                logger.info(\"کلیک بر روی اولین شغل\")\n                select_job_page = SelectJobPage(driver)\n                select_job_page.select_job()\n                logger.info(\"اولین شغل از لیست انتخاب شد.\")\n                logger.info(\"کلیک روی دکمه تایید...\")\n                select_job_page.click_confirm_job()\n                logger.info(\"دکمه 'ادامه' کلیک شد.\")\n    \n            with allure.step(\"Show and skip demo video\"):\n                logger.info(\"ویدیو آموزشی در حال پخش است ...\")\n                video_demo_page = VideoDemoPage(driver)\n                video_demo_page.click_confirm_video_demo()\n                logger.info(\"ویدیو آموزشی پخش و بر روی ادامه کلیک شد.\")\n    \n            try:\n                camera_permission_page = NotificationPermissionPage(driver)\n                camera_permission_page.allow_camera_permission()\n                logger.info(\"مجوز دوربین تأیید شد.\")\n                camera_permission_page.allow_camera_permission()\n                logger.info(\"محوز میکروفون تایید شد.\")\n    \n            except TimeoutException:\n                logger.info(\"مجوز دوربین نمایش داده نشد.\")\n    \n            # مرحله 21: ضبط ویدیو\n            with allure.step(\"Record video\"):\n                logger.info(\"دوربین سلفی جهت فیلم برداری باز شد...\")\n                video_record_page = VideoRecordingPage(driver)\n                video_record_page.click_video_recording()\n                logger.info(\"ضبط ویدیو شروع شد.\")\n                sleep(6)\n                video_record_page.click_stop_recording_button()\n                logger.info(\"ضبط ویدیو متوقف شد.\")\n                video_record_page.click_upload_video()\n                logger.info(\"ویدیو آپلود شد.\")\n    \n            with allure.step(\"Confirm video upload\"):\n                confirm_video_modal = ConfirmVideoModal(driver)\n                confirm_video_modal.click_confirm_video()\n                logger.info(\"آپلود ویدیو تایید شد.\")\n    \n            # مرحله 22: تایید نهایی و پایان\n            with allure.step(\"Final confirmation\"):\n                final_page = FinalPage(driver)\n                final_page.click_final_confirm()\n                logger.info(\"مراحل ایجاد حساب کاربری با موفقیت به پایان رسید.\")\n    \n            # مرحله 23: ورود به صفحه ورود و مقایسه نام کاربری\n            with allure.step(\"Verify displayed username in login page\"):\n                logger.info(\"انتقال به صفحه ورود و بررسی نام کاربری...\")\n                login_page = LoginPage(driver)\n    \n                # گرفتن متن از فیلد نام کاربری در صفحه ورود\n                displayed_username = login_page.get_username_text()\n    \n                # مقایسه با نام کاربری تولید شده در ابتدا\n                assert displayed_username == username, f\"Mismatch in username: Expected '{username}', but got '{displayed_username}'\"\n                logger.info(f\"Username verification successful: {displayed_username}\")\n        except Exception as e:\n    \n            logger.error(f\"خطا رخ داد: {e}\")\n            # اسکرین‌شات در صورت بروز هرگونه خطا\n            screenshot_path = capture_screenshot(driver, \"account_creation_error\")\n            allure.attach.file(screenshot_path, name=\"Error Screenshot\", attachment_type=allure.attachment_type.PNG)\n>           raise e\n\ntests\\kyc\\test_birth_certificate_old_upload.py:189: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntests\\kyc\\test_birth_certificate_old_upload.py:136: in test_birth_certificate_old_upload\n    video_demo_page.click_confirm_video_demo()\npages\\kyc\\kyc_pages.py:805: in click_confirm_video_demo\n    WebDriverWait(self.driver, 30).until(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <selenium.webdriver.support.wait.WebDriverWait (session=\"5731658c-e136-4ceb-8bfb-fae35cf13b07\")>\nmethod = <function VideoDemoPage.click_confirm_video_demo.<locals>.<lambda> at 0x0000020D6C3EE820>\nmessage = ''\n\n    def until(self, method: Callable[[D], Union[Literal[False], T]], message: str = \"\") -> T:\n        \"\"\"Calls the method provided with the driver as an argument until the \\\n        return value does not evaluate to ``False``.\n    \n        :param method: callable(WebDriver)\n        :param message: optional message for :exc:`TimeoutException`\n        :returns: the result of the last call to `method`\n        :raises: :exc:`selenium.common.exceptions.TimeoutException` if timeout occurs\n        \"\"\"\n        screen = None\n        stacktrace = None\n    \n        end_time = time.monotonic() + self._timeout\n        while True:\n            try:\n                value = method(self._driver)\n                if value:\n                    return value\n            except self._ignored_exceptions as exc:\n                screen = getattr(exc, \"screen\", None)\n                stacktrace = getattr(exc, \"stacktrace\", None)\n            time.sleep(self._poll)\n            if time.monotonic() > end_time:\n                break\n>       raise TimeoutException(message, screen, stacktrace)\nE       selenium.common.exceptions.TimeoutException: Message: \nE       Stacktrace:\nE       NoSuchElementError: An element could not be located on the page using the given search parameters.\nE           at AndroidUiautomator2Driver.findElOrEls (C:\\Users\\a.jamshidi\\.appium\\node_modules\\appium-uiautomator2-driver\\node_modules\\appium-android-driver\\lib\\commands\\find.ts:86:11)\nE           at processTicksAndRejections (node:internal/process/task_queues:95:5)\nE           at AndroidUiautomator2Driver.findElOrElsWithProcessing (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:60:12)\nE           at AndroidUiautomator2Driver.findElement (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:75:12)\n\n..\\..\\android_automation\\android_automation\\.venv\\lib\\site-packages\\selenium\\webdriver\\support\\wait.py:105: TimeoutException"}, "steps": [{"name": "User Information Setup", "status": "passed", "start": 1740467910463, "stop": 1740467910464}, {"name": "Click on 'Create Account' button", "status": "passed", "start": 1740467913835, "stop": 1740467914903}, {"name": "Click on 'Open Account' button", "status": "passed", "start": 1740467914952, "stop": 1740467916685}, {"name": "Click on 'UAT' from server selection", "status": "passed", "start": 1740467916685, "stop": 1740467916820}, {"name": "Click on 'Start' button", "status": "passed", "start": 1740467916821, "stop": 1740467918715}, {"name": "Check 'accept_rule_page_title' text", "status": "passed", "start": 1740467918715, "stop": 1740467918765}, {"name": "Check 'accept_rule_page_subtitle' text", "status": "passed", "start": 1740467918765, "stop": 1740467918817}, {"name": "Check 'create_account_step_title' text", "status": "passed", "start": 1740467918818, "stop": 1740467918861}, {"name": "Check 'create_account_step_subtitle' text", "status": "passed", "start": 1740467918861, "stop": 1740467918907}, {"name": "Check 'Identification_step_title' text", "status": "passed", "start": 1740467918907, "stop": 1740467918944}, {"name": "Check 'Check_information_step_title' text", "status": "passed", "start": 1740467918944, "stop": 1740467918985}, {"name": "Check 'card_order_step_title' text", "status": "passed", "start": 1740467918985, "stop": 1740467919034}, {"name": "Check 'rules_and_regulations_title' text", "status": "passed", "start": 1740467919034, "stop": 1740467919072}, {"name": "Check 'confirm_button_title' text", "status": "passed", "start": 1740467919072, "stop": 1740467919112}, {"name": "Check and toggle the agreement switch", "status": "passed", "start": 1740467919112, "stop": 1740467919921}, {"name": "Click confirm button after toggle", "status": "passed", "start": 1740467919921, "stop": 1740467921127}, {"name": "Check 'phone_number_page_header' text", "status": "passed", "start": 1740467921128, "stop": 1740467921201}, {"name": "Check 'phone_number_page_title' text", "status": "passed", "start": 1740467921201, "stop": 1740467921283}, {"name": "Check 'phone_number_field_text' text", "status": "passed", "start": 1740467921283, "stop": 1740467921346}, {"name": "Check 'phone_number_page_subtitle' text", "status": "passed", "start": 1740467921346, "stop": 1740467921414}, {"name": "Enter phone number", "status": "passed", "start": 1740467921414, "stop": 1740467922168}, {"name": "Click next button", "status": "passed", "start": 1740467922168, "stop": 1740467925180}, {"name": "Check 'مانند:‌ MDMGKP' text", "status": "passed", "start": 1740467925180, "stop": 1740467925248}, {"name": "Check 'referral_page_title' text", "status": "passed", "start": 1740467925248, "stop": 1740467925302}, {"name": "Click next button", "status": "passed", "start": 1740467925302, "stop": 1740467926640}, {"name": "Check 'national_code_title' text", "status": "passed", "start": 1740467926640, "stop": 1740467926715}, {"name": "Check 'کد ملی ۱۰ رقمی' text", "status": "passed", "start": 1740467926715, "stop": 1740467926776}, {"name": "Enter national code", "status": "passed", "start": 1740467926776, "stop": 1740467927491}, {"name": "Click next button", "status": "passed", "start": 1740467927491, "stop": 1740467929565}, {"name": "Check 'birth_day_page_title' text", "status": "passed", "start": 1740467929565, "stop": 1740467929647}, {"name": "Check 'birth_day_empty_field_text' text", "status": "passed", "start": 1740467929647, "stop": 1740467929721}, {"name": "Scroll year field", "status": "passed", "start": 1740467929721, "stop": 1740467930318}, {"name": "Click next button", "status": "passed", "start": 1740467930318, "stop": 1740467932626}, {"name": "Check 'username_page_title' text", "status": "passed", "start": 1740467932626, "stop": 1740467932726}, {"name": "Check 'username_field_text' text", "status": "passed", "start": 1740467932726, "stop": 1740467932797}, {"name": "Enter new username", "status": "passed", "start": 1740467932798, "stop": 1740467933516}, {"name": "Click next button", "status": "passed", "start": 1740467933516, "stop": 1740467934887}, {"name": "Check 'password_page_title' text", "status": "passed", "start": 1740467934887, "stop": 1740467934981}, {"name": "Check 'password_page_field_text' text", "status": "passed", "start": 1740467934981, "stop": 1740467935047}, {"name": "Check 'password_condition_lowercase_and_uppercase' text", "status": "passed", "start": 1740467935047, "stop": 1740467935126}, {"name": "Check 'password_condition_minimum_characters' text", "status": "passed", "start": 1740467935126, "stop": 1740467935209}, {"name": "Check 'password_condition_number' text", "status": "passed", "start": 1740467935209, "stop": 1740467935287}, {"name": "Check 'password_page_subtitle' text", "status": "passed", "start": 1740467935287, "stop": 1740467935357}, {"name": "Enter password", "status": "passed", "start": 1740467935357, "stop": 1740467936093}, {"name": "Click next button", "status": "passed", "start": 1740467936093, "stop": 1740467937445}, {"name": "Click next button", "status": "passed", "start": 1740467937445, "stop": 1740467939784}, {"name": "Select job for user", "status": "passed", "start": 1740467939784, "stop": 1740467942003}, {"name": "Show and skip demo video", "status": "broken", "statusDetails": {"message": "selenium.common.exceptions.TimeoutException: Message: \nStacktrace:\nNoSuchElementError: An element could not be located on the page using the given search parameters.\n    at AndroidUiautomator2Driver.findElOrEls (C:\\Users\\a.jamshidi\\.appium\\node_modules\\appium-uiautomator2-driver\\node_modules\\appium-android-driver\\lib\\commands\\find.ts:86:11)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at AndroidUiautomator2Driver.findElOrElsWithProcessing (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:60:12)\n    at AndroidUiautomator2Driver.findElement (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:75:12)\n", "trace": "  File \"C:\\Users\\a.jamshidi\\Videos\\android-automation\\tests\\kyc\\test_birth_certificate_old_upload.py\", line 136, in test_birth_certificate_old_upload\n    video_demo_page.click_confirm_video_demo()\n  File \"C:\\Users\\a.jamshidi\\Videos\\android-automation\\pages\\kyc\\kyc_pages.py\", line 805, in click_confirm_video_demo\n    WebDriverWait(self.driver, 30).until(\n  File \"C:\\Users\\a.jamshidi\\android_automation\\android_automation\\.venv\\lib\\site-packages\\selenium\\webdriver\\support\\wait.py\", line 105, in until\n    raise TimeoutException(message, screen, stacktrace)\n"}, "start": 1740467942003, "stop": 1740467972253}], "attachments": [{"name": "Error Screenshot", "source": "a6b2686c-ee28-4a6f-bb89-7f1f111c194a-attachment.png", "type": "image/png"}, {"name": "log", "source": "056bb91f-5785-4b47-b8b6-18deb971264b-attachment.txt", "type": "text/plain"}, {"name": "stderr", "source": "942d0bc2-bb4d-437c-a09d-0c1e861211e7-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "Phone Number", "value": "'09199472365'"}, {"name": "National Code", "value": "'7111543904'"}, {"name": "Username", "value": "'amin2'"}], "start": 1740467910462, "stop": 1740467974195, "uuid": "c4579827-6c5c-4a44-a882-c8ce012a0981", "historyId": "b39843c722aa938f4d2e5912d9236cfb", "testCaseId": "8dd0fc9c43daa497976fa20cd9650433", "fullName": "tests.kyc.test_birth_certificate_old_upload#test_birth_certificate_old_upload", "labels": [{"name": "suite", "value": "version:v3.5.0"}, {"name": "story", "value": "Complete account creation by uploading old birth certificate"}, {"name": "feature", "value": "Create a new user account - Old Birth Certificate Upload"}, {"name": "epic", "value": "KYC"}, {"name": "subSuite", "value": "Tests for Old Birth Certificate Upload"}, {"name": "severity", "value": "blocker"}, {"name": "parentSuite", "value": "tests.kyc"}, {"name": "host", "value": "ajamshidi-lap-qa"}, {"name": "thread", "value": "71104-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.kyc.test_birth_certificate_old_upload"}], "links": [{"type": "link", "url": "https://jira.sdb247.com/browse/", "name": "Jira Task"}]}